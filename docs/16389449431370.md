# 代码设计的思考

将事物的共性抽象为类，将共有的行为定义为方法，可有效提升代码复用。
如iOS中常用的BaseViewController，但是很容易造成基类变成一个垃圾桶，什么玩意都往里放。除此之外，开发者应该有更高一层的抽象意识来解决开发中的问题。

## 通过协议
1.协议应该理解为一种能力
遵循了协议，那么你会获取一种能力；你拥有了一个遵循协议的对象，那么你可以通过这个对象去使用这种能力。

1.1 常见的，将打开相册或者关闭键盘，定义为协议，通过extension添加默认实现。那么遵循协议的类，即获得这两种能力。而且方便与其他协议（能力）进行组合。避免了硬塞一大堆代码到BaseViewController的问题

1.2 使用协议内定义的能力
如你写一个弹框组件，弹框视图的动画方法方式各种各样，可以将这个定义为协议，弹框组件去获取协议对象来做具体的动画，这样就可以把具体的动画操作交给调用方去实现，从而达到扩展和解耦的目的

```
//拿到协议对象，调用方法即可
public protocol YFPopupProtocol: AnyObject {
    func show(animiated: Bool)
    func hide(animiated: Bool)
}
```


## 通过函数式

将操作抽象为一个个的函数，使用swift的高阶函数组装起来。具体可以参数智投项目中的账户和密码的校验，将每一个校验封装为Rule。

参考书，可以看Objc中国的《函数式swift》。

## 通过对业务的提炼

协议和函数式编程，是很趁手的两个代码设计的工具，因为有对应的语言特性可用。

但是，可以看到目前SuperApp内Processor和 Flow的设计，其实是都没有用到这两个工具。所以更多的时候，**需要结合业务本身去做抽象，如果只是会封装个类，其实是层次很低的抽象**。

在我的理解中，Processor是横向解耦，它分离出很多平行的插件，来将业务逻辑分散到各个相对队里的插件中。Flow是竖向解耦，因为业务关系，比如在提交订单的时候，你需要先校验A在校验B，而且A很可能不是单独一个验证，很有可能是一类前置条件的校验，所以才提炼出这种的设计。那么从这个角度来看，其实是可以用函数式编程来重构Flow的：将每一个验证，抽象为一个函数 在用高阶函数组合起来

同时，实践的时候，应当考虑团队其他成员的接受程度，是否愿意使用，不要搞得自己很孤立。
